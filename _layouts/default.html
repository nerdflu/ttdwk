<!doctype html><html lang="en-AU">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  {% seo %}
  <link rel="stylesheet" href="{{ '/assets/styles.css' | relative_url }}?v={{ site.github.build_revision | default: site.time | date: '%s' }}">
</head>

{% comment %}
Derive page context + sidebar rules
{% endcomment %}
{% comment %} Flags are derived inline in conditionals below (avoid invalid comparisons in assign). {% endcomment %}

{% assign sidebar_variant = page.sidebar %}
{% assign city_slug = page.city_slug %}
{% if page.collection == "cities" %}{% assign city_slug = page.slug %}{% endif %}
{% if page.collection == "activities" %}{% assign city_slug = page.city %}{% endif %}

{% assign current_city = page.current_city %}
{% if current_city == nil and city_slug %}
  {% assign current_city = site.cities | where: "slug", city_slug | first %}
{% endif %}

{% assign show_sidebar = "" %}
{% if sidebar_variant %}
  {% assign show_sidebar = "1" %}
{% elsif page.collection == "cities" or page.collection == "activities" %}
  {% assign show_sidebar = "1" %}
{% elsif page.url != "/" %}
  {% assign show_sidebar = "1" %}
{% endif %}

{% if show_sidebar and sidebar_variant == nil %}
  {% assign sidebar_variant = "city" %}
{% endif %}

<body class="{% if show_sidebar %}has-sidebar{% endif %}">
  {% include site-header.html show_sidebar=show_sidebar %}

  <div class="site-shell">
    <div class="layout{% if show_sidebar %} with-sidebar{% endif %}">
      {% if show_sidebar %}
        {% include sidebar.html city_slug=city_slug current_city=current_city sidebar_variant=sidebar_variant %}
      {% endif %}
      <main class="content"><h1>{{ page.h1 | default: page.title }}</h1>{{ content }}</main>
    </div>
  </div>

  {% include site-footer.html %}
  <script>{% include sidebar-toggle.js %}</script>
</body>
</html>